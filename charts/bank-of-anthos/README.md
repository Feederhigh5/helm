# bank-of-anthos

![Version: 0.2.0](https://img.shields.io/badge/Version-0.2.0-informational?style=flat-square) ![Type: application](https://img.shields.io/badge/Type-application-informational?style=flat-square) ![AppVersion: 0.5.10](https://img.shields.io/badge/AppVersion-0.5.10-informational?style=flat-square)

A Helm chart for Google's Demo Application Bank of Anthos https://github.com/GoogleCloudPlatform/bank-of-anthos

## Values

| Key | Type | Default | Description |
|-----|------|---------|-------------|
| appVersion | string | `"v0.5.10"` | sets the version of bank-of-anthos that should be deployed (sets the image tags) |
| configMaps | object | `{"accountsdb":{"data":{"ACCOUNTS_DB_URI":"postgresql://accounts-admin:accounts-pwd@accounts-db:5432/accounts-db","POSTGRES_DB":"accounts-db","POSTGRES_PASSWORD":"accounts-pwd","POSTGRES_USER":"accounts-admin"},"labels":{"app":"accounts-db"},"name":"accounts-db-config"},"demoData":{"data":{"DEMO_LOGIN_PASSWORD":"bankofanthos","DEMO_LOGIN_USERNAME":"testuser","USE_DEMO_DATA":"True"},"name":"demo-data-config"},"environment":{"data":{"LOCAL_ROUTING_NUM":"883745000","PUB_KEY_PATH":"/tmp/.ssh/publickey"},"name":"environment-config"},"ledgerdb":{"data":{"POSTGRES_DB":"postgresdb","POSTGRES_PASSWORD":"password","POSTGRES_USER":"admin","SPRING_DATASOURCE_PASSWORD":"password","SPRING_DATASOURCE_URL":"jdbc:postgresql://ledger-db:5432/postgresdb","SPRING_DATASOURCE_USERNAME":"admin"},"labels":{"app":"postgres"},"name":"ledger-db-config"},"serviceApi":{"data":{"BALANCES_API_ADDR":"balancereader:8080","CONTACTS_API_ADDR":"contacts:8080","HISTORY_API_ADDR":"transactionhistory:8080","TRANSACTIONS_API_ADDR":"ledgerwriter:8080","USERSERVICE_API_ADDR":"userservice:8080"},"name":"service-api-config"}}` | configuration for configmaps |
| configMaps.demoData.data.DEMO_LOGIN_PASSWORD | string | `"bankofanthos"` | All demo user accounts are hardcoded to use the login password 'bankofanthos' |
| configMaps.ledgerdb.data.SPRING_DATASOURCE_PASSWORD | string | `"password"` | should match POSTGRES_PASSWORD |
| configMaps.ledgerdb.data.SPRING_DATASOURCE_USERNAME | string | `"admin"` | should match POSTGRES_USER |
| deployments | object | `{"balance-reader":{"app":"balancereader","container":{"env":{"CACHE_SIZE":"1000000","ENABLE_METRICS":"false","ENABLE_TRACING":"false","JVM_OPTS":"-XX:+UnlockExperimentalVMOptions -XX:+UseCGroupMemoryLimitForHeap -Xms256m -Xmx512m","LOG_LEVEL":"info","POLL_MS":"100","PORT":"8080","VERSION":"{{ $.Values.appVersion }}"},"envFrom":"- configMapRef:\n    name: {{ $.Values.configMaps.environment.name }}\n# add ledger-db credentials from ConfigMap\n- configMapRef:\n    name: {{ $.Values.configMaps.ledgerdb.name }}\n","extraEnv":[{"name":"NAMESPACE","valueFrom":{"fieldRef":{"fieldPath":"metadata.namespace"}}}],"image":"gcr.io/bank-of-anthos-ci/balancereader","livenessProbe":{"httpGet":{"path":"/healthy","port":8080},"initialDelaySeconds":120,"periodSeconds":5,"timeoutSeconds":10},"name":"balancereader","readinessProbe":{"httpGet":{"path":"/ready","port":8080},"initialDelaySeconds":60,"periodSeconds":5,"timeoutSeconds":10},"resources":{"limits":{"cpu":"500m","memory":"512Mi"},"requests":{"cpu":"100m","memory":"256Mi"}},"securityContext":{"allowPrivilegeEscalation":false,"capabilities":{"drop":["all"]},"privileged":false,"readOnlyRootFilesystem":true},"startupProbe":{"failureThreshold":30,"httpGet":{"path":"/healthy","port":8080},"periodSeconds":10},"volumeMounts":[{"mountPath":"/tmp/.ssh","name":"publickey","readOnly":true},{"mountPath":"/tmp","name":"tmp"}]},"name":"balancereader","podAnnotations":{},"podSecurityContext":{"fsGroup":1000,"runAsGroup":1000,"runAsNonRoot":true,"runAsUser":1000},"service":{"name":"balancereader","ports":[{"name":"http","port":8080,"targetPort":8080}],"type":"ClusterIP"},"serviceAccountName":"default","terminationGracePeriodSeconds":5,"volumes":[{"name":"publickey","secret":{"items":[{"key":"jwtRS256.key.pub","path":"publickey"}],"secretName":"jwt-key"}},{"emptyDir":{},"name":"tmp"}]},"contacts":{"app":"contacts","container":{"env":{"ENABLE_TRACING":"false","LOG_LEVEL":"info","PORT":"8080","VERSION":"{{ $.Values.appVersion }}"},"envFrom":"- configMapRef:\n    name: {{ $.Values.configMaps.environment.name }}\n- configMapRef:\n    name: {{ $.Values.configMaps.accountsdb.name }}\n","extraEnv":{},"image":"gcr.io/bank-of-anthos-ci/contacts","name":"contacts","readinessProbe":{"httpGet":{"path":"/ready","port":8080},"initialDelaySeconds":60,"periodSeconds":5,"timeoutSeconds":10},"resources":{"limits":{"cpu":"250m","memory":"128Mi"},"requests":{"cpu":"100m","memory":"64Mi"}},"securityContext":{"allowPrivilegeEscalation":false,"capabilities":{"drop":["all"]},"privileged":false,"readOnlyRootFilesystem":true},"volumeMounts":[{"mountPath":"/tmp/.ssh","name":"publickey","readOnly":true},{"mountPath":"/tmp","name":"tmp"}]},"name":"contacts","podAnnotations":{},"podSecurityContext":{"fsGroup":1000,"runAsGroup":1000,"runAsNonRoot":true,"runAsUser":1000},"service":{"name":"contacts","ports":[{"name":"http","port":8080,"targetPort":8080}],"type":"ClusterIP"},"serviceAccountName":"default","terminationGracePeriodSeconds":5,"volumes":[{"name":"publickey","secret":{"items":[{"key":"jwtRS256.key.pub","path":"publickey"}],"secretName":"jwt-key"}},{"emptyDir":{},"name":"tmp"}]},"frontend":{"app":"frontend","container":{"env":{"CLUSTER_NAME":"mycluster-fra02-b3c.4x16","CYMBAL_LOGO":"false","ENABLE_TRACING":"false","LOG_LEVEL":"info","PORT":"8080","SCHEME":"http","VERSION":"{{ $.Values.appVersion }}"},"envFrom":"- configMapRef:\n    name: {{ $.Values.configMaps.environment.name }}\n- configMapRef:\n    name: {{ $.Values.configMaps.serviceApi.name }}\n","extraEnv":[{"name":"DEFAULT_USERNAME","valueFrom":{"configMapKeyRef":{"key":"DEMO_LOGIN_USERNAME","name":"demo-data-config"}}},{"name":"DEFAULT_PASSWORD","valueFrom":{"configMapKeyRef":{"key":"DEMO_LOGIN_PASSWORD","name":"demo-data-config"}}},{"name":"REGISTERED_OAUTH_CLIENT_ID","valueFrom":{"configMapKeyRef":{"key":"DEMO_OAUTH_CLIENT_ID","name":"oauth-config","optional":true}}},{"name":"ALLOWED_OAUTH_REDIRECT_URI","valueFrom":{"configMapKeyRef":{"key":"DEMO_OAUTH_REDIRECT_URI","name":"oauth-config","optional":true}}}],"image":"gcr.io/bank-of-anthos-ci/frontend","livenessProbe":{"httpGet":{"path":"/ready","port":8080},"initialDelaySeconds":60,"periodSeconds":15,"timeoutSeconds":30},"name":"frontend","ports":[{"containerPort":8080,"name":"http","protocol":"TCP"}],"readinessProbe":{"httpGet":{"path":"/ready","port":8080},"initialDelaySeconds":10,"periodSeconds":5,"timeoutSeconds":10},"resources":{"limits":{"cpu":"250m","memory":"128Mi"},"requests":{"cpu":"100m","memory":"64Mi"}},"securityContext":{"allowPrivilegeEscalation":false,"capabilities":{"drop":["all"]},"privileged":false,"readOnlyRootFilesystem":true},"volumeMounts":[{"mountPath":"/tmp/.ssh","name":"publickey","readOnly":true},{"mountPath":"/tmp","name":"tmp"}]},"name":"frontend","podAnnotations":{},"podSecurityContext":{"fsGroup":1000,"runAsGroup":1000,"runAsNonRoot":true,"runAsUser":1000},"service":{"name":"frontend","ports":[{"name":"http","port":80,"targetPort":8080}],"type":"LoadBalancer"},"serviceAccountName":"default","terminationGracePeriodSeconds":5,"volumes":[{"name":"publickey","secret":{"items":[{"key":"jwtRS256.key.pub","path":"publickey"}],"secretName":"jwt-key"}},{"emptyDir":{},"name":"tmp"}]},"ledger-writer":{"app":"ledgerwriter","container":{"env":{"ENABLE_METRICS":"false","ENABLE_TRACING":"false","JVM_OPTS":"-XX:+UnlockExperimentalVMOptions -XX:+UseCGroupMemoryLimitForHeap -Xms256m -Xmx512m","LOG_LEVEL":"info","PORT":"8080","VERSION":"{{ $.Values.appVersion }}"},"envFrom":"- configMapRef:\n    name: {{ $.Values.configMaps.environment.name }}\n- configMapRef:\n    name: {{ $.Values.configMaps.serviceApi.name }}\n# -- add ledger-db credentials from ConfigMap\n- configMapRef:\n    name: {{ $.Values.configMaps.ledgerdb.name }}\n","extraEnv":[{"name":"NAMESPACE","valueFrom":{"fieldRef":{"fieldPath":"metadata.namespace"}}}],"image":"gcr.io/bank-of-anthos-ci/ledgerwriter","name":"ledgerwriter","readinessProbe":{"httpGet":{"path":"/ready","port":8080},"initialDelaySeconds":60,"periodSeconds":5,"timeoutSeconds":10},"resources":{"limits":{"cpu":"500m","memory":"512Mi"},"requests":{"cpu":"100m","memory":"256Mi"}},"securityContext":{"allowPrivilegeEscalation":false,"capabilities":{"drop":["all"]},"privileged":false,"readOnlyRootFilesystem":true},"startupProbe":{"failureThreshold":30,"httpGet":{"path":"/ready","port":8080},"periodSeconds":10},"volumeMounts":[{"mountPath":"/tmp/.ssh","name":"publickey","readOnly":true},{"mountPath":"/tmp","name":"tmp"}]},"name":"ledgerwriter","podAnnotations":{},"podSecurityContext":{"fsGroup":1000,"runAsGroup":1000,"runAsNonRoot":true,"runAsUser":1000,"securityContext":null},"service":{"name":"ledgerwriter","ports":[{"name":"http","port":8080,"targetPort":8080}],"type":"ClusterIP"},"serviceAccountName":"default","terminationGracePeriodSeconds":5,"volumes":[{"name":"publickey","secret":{"items":[{"key":"jwtRS256.key.pub","path":"publickey"}],"secretName":"jwt-key"}},{"emptyDir":{},"name":"tmp"}]},"loadgenerator":{"app":"loadgenerator","container":{"command":["locust","--autostart"],"env":{"LOCUST_HOST":"http://frontend","LOCUST_LOGLEVEL":"info","LOCUST_SPAWN_RATE":"1","LOCUST_USERS":"5","LOCUST_WEB_PORT":"8080"},"image":"gcr.io/bank-of-anthos-ci/loadgenerator","name":"loadgenerator","resources":{"limits":{"cpu":"250m","memory":"1Gi"},"requests":{"cpu":"100m","memory":"512Mi"}},"securityContext":{"allowPrivilegeEscalation":false,"capabilities":{"drop":["all"]},"privileged":false,"readOnlyRootFilesystem":true}},"name":"loadgenerator","podAnnotations":{"sidecar.istio.io/rewriteAppHTTPProbers":"true"},"podSecurityContext":{"fsGroup":1000,"runAsGroup":1000,"runAsNonRoot":true,"runAsUser":1000},"replicas":1,"restartPolicy":"Always","serviceAccountName":"default","terminationGracePeriodSeconds":5},"transaction-history":{"app":"transactionhistory","container":{"env":{"CACHE_MINUTES":"60","CACHE_SIZE":"1000","ENABLE_METRICS":"false","ENABLE_TRACING":"false","HISTORY_LIMIT":"100","JVM_OPTS":"-XX:+UnlockExperimentalVMOptions -XX:+UseCGroupMemoryLimitForHeap -Xms256m -Xmx512m","LOG_LEVEL":"info","POLL_MS":"100","PORT":"8080","VERSION":"{{ $.Values.appVersion }}"},"envFrom":"- configMapRef:\n    name: {{ $.Values.configMaps.environment.name }}\n# -- add ledger-db credentials from ConfigMap\n- configMapRef:\n    name: {{ $.Values.configMaps.ledgerdb.name }}\n","extraEnv":[{"name":"NAMESPACE","valueFrom":{"fieldRef":{"fieldPath":"metadata.namespace"}}}],"image":"gcr.io/bank-of-anthos-ci/transactionhistory","livenessProbe":{"httpGet":{"path":"/healthy","port":8080},"initialDelaySeconds":120,"periodSeconds":5,"timeoutSeconds":10},"name":"transactionhistory","readinessProbe":{"httpGet":{"path":"/ready","port":8080},"initialDelaySeconds":60,"periodSeconds":5,"timeoutSeconds":10},"resources":{"limits":{"cpu":"500m","memory":"512Mi"},"requests":{"cpu":"100m","memory":"256Mi"}},"securityContext":{"allowPrivilegeEscalation":false,"capabilities":{"drop":["all"]},"privileged":false,"readOnlyRootFilesystem":true},"startupProbe":{"failureThreshold":30,"httpGet":{"path":"/healthy","port":8080},"periodSeconds":10},"volumeMounts":[{"mountPath":"/tmp/.ssh","name":"publickey","readOnly":true},{"mountPath":"/tmp","name":"tmp"}]},"name":"transactionhistory","podAnnotations":{},"podSecurityContext":{"fsGroup":1000,"runAsGroup":1000,"runAsNonRoot":true,"runAsUser":1000},"service":{"name":"transactionhistory","ports":[{"name":"http","port":8080,"targetPort":8080}],"type":"ClusterIP"},"serviceAccountName":"default","terminationGracePeriodSeconds":5,"volumes":[{"name":"publickey","secret":{"items":[{"key":"jwtRS256.key.pub","path":"publickey"}],"secretName":"jwt-key"}},{"emptyDir":{},"name":"tmp"}]},"userservice":{"app":"userservice","container":{"env":{"ENABLE_TRACING":"false","LOG_LEVEL":"info","PORT":"8080","PRIV_KEY_PATH":"/tmp/.ssh/privatekey","TOKEN_EXPIRY_SECONDS":"3600","VERSION":"{{ $.Values.appVersion }}"},"envFrom":"- configMapRef:\n    name: {{ $.Values.configMaps.environment.name }}\n- configMapRef:\n    name: {{ $.Values.configMaps.accountsdb.name }}\n","image":"gcr.io/bank-of-anthos-ci/userservice","name":"userservice","ports":[{"containerPort":8080,"name":"http-server"}],"readinessProbe":{"httpGet":{"path":"/ready","port":8080},"initialDelaySeconds":10,"periodSeconds":5,"timeoutSeconds":10},"resources":{"limits":{"cpu":"500m","memory":"256Mi"},"requests":{"cpu":"300m","memory":"128Mi"}},"securityContext":{"allowPrivilegeEscalation":false,"capabilities":{"drop":["all"]},"privileged":false,"readOnlyRootFilesystem":true},"volumeMounts":[{"mountPath":"/tmp/.ssh","name":"keys","readOnly":true},{"mountPath":"/tmp","name":"tmp"}]},"name":"userservice","podAnnotations":{},"podSecurityContext":{"fsGroup":1000,"runAsGroup":1000,"runAsNonRoot":true,"runAsUser":1000},"service":{"name":"userservice","ports":[{"name":"http","port":8080,"targetPort":8080}],"type":"ClusterIP"},"serviceAccountName":"default","terminationGracePeriodSeconds":5,"volumes":[{"name":"keys","secret":{"items":[{"key":"jwtRS256.key","path":"privatekey"},{"key":"jwtRS256.key.pub","path":"publickey"}],"secretName":"jwt-key"}},{"emptyDir":{},"name":"tmp"}]}}` | values for the deployments |
| deployments.balance-reader | object | `{"app":"balancereader","container":{"env":{"CACHE_SIZE":"1000000","ENABLE_METRICS":"false","ENABLE_TRACING":"false","JVM_OPTS":"-XX:+UnlockExperimentalVMOptions -XX:+UseCGroupMemoryLimitForHeap -Xms256m -Xmx512m","LOG_LEVEL":"info","POLL_MS":"100","PORT":"8080","VERSION":"{{ $.Values.appVersion }}"},"envFrom":"- configMapRef:\n    name: {{ $.Values.configMaps.environment.name }}\n# add ledger-db credentials from ConfigMap\n- configMapRef:\n    name: {{ $.Values.configMaps.ledgerdb.name }}\n","extraEnv":[{"name":"NAMESPACE","valueFrom":{"fieldRef":{"fieldPath":"metadata.namespace"}}}],"image":"gcr.io/bank-of-anthos-ci/balancereader","livenessProbe":{"httpGet":{"path":"/healthy","port":8080},"initialDelaySeconds":120,"periodSeconds":5,"timeoutSeconds":10},"name":"balancereader","readinessProbe":{"httpGet":{"path":"/ready","port":8080},"initialDelaySeconds":60,"periodSeconds":5,"timeoutSeconds":10},"resources":{"limits":{"cpu":"500m","memory":"512Mi"},"requests":{"cpu":"100m","memory":"256Mi"}},"securityContext":{"allowPrivilegeEscalation":false,"capabilities":{"drop":["all"]},"privileged":false,"readOnlyRootFilesystem":true},"startupProbe":{"failureThreshold":30,"httpGet":{"path":"/healthy","port":8080},"periodSeconds":10},"volumeMounts":[{"mountPath":"/tmp/.ssh","name":"publickey","readOnly":true},{"mountPath":"/tmp","name":"tmp"}]},"name":"balancereader","podAnnotations":{},"podSecurityContext":{"fsGroup":1000,"runAsGroup":1000,"runAsNonRoot":true,"runAsUser":1000},"service":{"name":"balancereader","ports":[{"name":"http","port":8080,"targetPort":8080}],"type":"ClusterIP"},"serviceAccountName":"default","terminationGracePeriodSeconds":5,"volumes":[{"name":"publickey","secret":{"items":[{"key":"jwtRS256.key.pub","path":"publickey"}],"secretName":"jwt-key"}},{"emptyDir":{},"name":"tmp"}]}` | configuration for balance-reader deployment |
| deployments.balance-reader.container.env | object | `{"CACHE_SIZE":"1000000","ENABLE_METRICS":"false","ENABLE_TRACING":"false","JVM_OPTS":"-XX:+UnlockExperimentalVMOptions -XX:+UseCGroupMemoryLimitForHeap -Xms256m -Xmx512m","LOG_LEVEL":"info","POLL_MS":"100","PORT":"8080","VERSION":"{{ $.Values.appVersion }}"}` | envs are inserted as name/value pairs |
| deployments.balance-reader.container.env.ENABLE_TRACING | string | `"false"` | toggle Cloud Trace export |
| deployments.balance-reader.container.env.JVM_OPTS | string | `"-XX:+UnlockExperimentalVMOptions -XX:+UseCGroupMemoryLimitForHeap -Xms256m -Xmx512m"` | tell Java to obey container memory limits |
| deployments.balance-reader.container.env.LOG_LEVEL | string | `"info"` | Valid levels are debug, info, warn, error, fatal. If no valid level is set, will default to info. |
| deployments.balance-reader.container.extraEnv | list | `[{"name":"NAMESPACE","valueFrom":{"fieldRef":{"fieldPath":"metadata.namespace"}}}]` | extraEnv are inserted directly as Yaml |
| deployments.balance-reader.container.image | string | `"gcr.io/bank-of-anthos-ci/balancereader"` | version tag is set by appVersion value |
| deployments.contacts | object | `{"app":"contacts","container":{"env":{"ENABLE_TRACING":"false","LOG_LEVEL":"info","PORT":"8080","VERSION":"{{ $.Values.appVersion }}"},"envFrom":"- configMapRef:\n    name: {{ $.Values.configMaps.environment.name }}\n- configMapRef:\n    name: {{ $.Values.configMaps.accountsdb.name }}\n","extraEnv":{},"image":"gcr.io/bank-of-anthos-ci/contacts","name":"contacts","readinessProbe":{"httpGet":{"path":"/ready","port":8080},"initialDelaySeconds":60,"periodSeconds":5,"timeoutSeconds":10},"resources":{"limits":{"cpu":"250m","memory":"128Mi"},"requests":{"cpu":"100m","memory":"64Mi"}},"securityContext":{"allowPrivilegeEscalation":false,"capabilities":{"drop":["all"]},"privileged":false,"readOnlyRootFilesystem":true},"volumeMounts":[{"mountPath":"/tmp/.ssh","name":"publickey","readOnly":true},{"mountPath":"/tmp","name":"tmp"}]},"name":"contacts","podAnnotations":{},"podSecurityContext":{"fsGroup":1000,"runAsGroup":1000,"runAsNonRoot":true,"runAsUser":1000},"service":{"name":"contacts","ports":[{"name":"http","port":8080,"targetPort":8080}],"type":"ClusterIP"},"serviceAccountName":"default","terminationGracePeriodSeconds":5,"volumes":[{"name":"publickey","secret":{"items":[{"key":"jwtRS256.key.pub","path":"publickey"}],"secretName":"jwt-key"}},{"emptyDir":{},"name":"tmp"}]}` | configuration for contacts deployment |
| deployments.contacts.container.env | object | `{"ENABLE_TRACING":"false","LOG_LEVEL":"info","PORT":"8080","VERSION":"{{ $.Values.appVersion }}"}` | envs are inserted as name/value pairs |
| deployments.contacts.container.env.ENABLE_TRACING | string | `"false"` | toggle Cloud Trace export |
| deployments.contacts.container.env.LOG_LEVEL | string | `"info"` | Valid levels are debug, info, warn, error, fatal. If no valid level is set, will default to info. |
| deployments.contacts.container.extraEnv | object | `{}` | extraEnv are inserted directly as Yaml |
| deployments.contacts.container.image | string | `"gcr.io/bank-of-anthos-ci/contacts"` | version tag is set by appVersion value |
| deployments.frontend | object | `{"app":"frontend","container":{"env":{"CLUSTER_NAME":"mycluster-fra02-b3c.4x16","CYMBAL_LOGO":"false","ENABLE_TRACING":"false","LOG_LEVEL":"info","PORT":"8080","SCHEME":"http","VERSION":"{{ $.Values.appVersion }}"},"envFrom":"- configMapRef:\n    name: {{ $.Values.configMaps.environment.name }}\n- configMapRef:\n    name: {{ $.Values.configMaps.serviceApi.name }}\n","extraEnv":[{"name":"DEFAULT_USERNAME","valueFrom":{"configMapKeyRef":{"key":"DEMO_LOGIN_USERNAME","name":"demo-data-config"}}},{"name":"DEFAULT_PASSWORD","valueFrom":{"configMapKeyRef":{"key":"DEMO_LOGIN_PASSWORD","name":"demo-data-config"}}},{"name":"REGISTERED_OAUTH_CLIENT_ID","valueFrom":{"configMapKeyRef":{"key":"DEMO_OAUTH_CLIENT_ID","name":"oauth-config","optional":true}}},{"name":"ALLOWED_OAUTH_REDIRECT_URI","valueFrom":{"configMapKeyRef":{"key":"DEMO_OAUTH_REDIRECT_URI","name":"oauth-config","optional":true}}}],"image":"gcr.io/bank-of-anthos-ci/frontend","livenessProbe":{"httpGet":{"path":"/ready","port":8080},"initialDelaySeconds":60,"periodSeconds":15,"timeoutSeconds":30},"name":"frontend","ports":[{"containerPort":8080,"name":"http","protocol":"TCP"}],"readinessProbe":{"httpGet":{"path":"/ready","port":8080},"initialDelaySeconds":10,"periodSeconds":5,"timeoutSeconds":10},"resources":{"limits":{"cpu":"250m","memory":"128Mi"},"requests":{"cpu":"100m","memory":"64Mi"}},"securityContext":{"allowPrivilegeEscalation":false,"capabilities":{"drop":["all"]},"privileged":false,"readOnlyRootFilesystem":true},"volumeMounts":[{"mountPath":"/tmp/.ssh","name":"publickey","readOnly":true},{"mountPath":"/tmp","name":"tmp"}]},"name":"frontend","podAnnotations":{},"podSecurityContext":{"fsGroup":1000,"runAsGroup":1000,"runAsNonRoot":true,"runAsUser":1000},"service":{"name":"frontend","ports":[{"name":"http","port":80,"targetPort":8080}],"type":"LoadBalancer"},"serviceAccountName":"default","terminationGracePeriodSeconds":5,"volumes":[{"name":"publickey","secret":{"items":[{"key":"jwtRS256.key.pub","path":"publickey"}],"secretName":"jwt-key"}},{"emptyDir":{},"name":"tmp"}]}` | configuration for frontend deployment |
| deployments.frontend.container.env.CLUSTER_NAME | string | `"mycluster-fra02-b3c.4x16"` | Customize the cluster name if it cannot be retrieved from the metadata server |
| deployments.frontend.container.env.CYMBAL_LOGO | string | `"false"` | Set to "true" to enable the CymbalBank logo + title |
| deployments.frontend.container.env.ENABLE_TRACING | string | `"false"` | toggle Cloud Trace export |
| deployments.frontend.container.env.LOG_LEVEL | string | `"info"` | Valid levels are debug, info, warn, error, fatal. If no valid level is set, will default to info. |
| deployments.frontend.container.image | string | `"gcr.io/bank-of-anthos-ci/frontend"` | version tag is set by appVersion value |
| deployments.frontend.container.ports | list | `[{"containerPort":8080,"name":"http","protocol":"TCP"}]` | port previously not defined..? |
| deployments.ledger-writer | object | `{"app":"ledgerwriter","container":{"env":{"ENABLE_METRICS":"false","ENABLE_TRACING":"false","JVM_OPTS":"-XX:+UnlockExperimentalVMOptions -XX:+UseCGroupMemoryLimitForHeap -Xms256m -Xmx512m","LOG_LEVEL":"info","PORT":"8080","VERSION":"{{ $.Values.appVersion }}"},"envFrom":"- configMapRef:\n    name: {{ $.Values.configMaps.environment.name }}\n- configMapRef:\n    name: {{ $.Values.configMaps.serviceApi.name }}\n# -- add ledger-db credentials from ConfigMap\n- configMapRef:\n    name: {{ $.Values.configMaps.ledgerdb.name }}\n","extraEnv":[{"name":"NAMESPACE","valueFrom":{"fieldRef":{"fieldPath":"metadata.namespace"}}}],"image":"gcr.io/bank-of-anthos-ci/ledgerwriter","name":"ledgerwriter","readinessProbe":{"httpGet":{"path":"/ready","port":8080},"initialDelaySeconds":60,"periodSeconds":5,"timeoutSeconds":10},"resources":{"limits":{"cpu":"500m","memory":"512Mi"},"requests":{"cpu":"100m","memory":"256Mi"}},"securityContext":{"allowPrivilegeEscalation":false,"capabilities":{"drop":["all"]},"privileged":false,"readOnlyRootFilesystem":true},"startupProbe":{"failureThreshold":30,"httpGet":{"path":"/ready","port":8080},"periodSeconds":10},"volumeMounts":[{"mountPath":"/tmp/.ssh","name":"publickey","readOnly":true},{"mountPath":"/tmp","name":"tmp"}]},"name":"ledgerwriter","podAnnotations":{},"podSecurityContext":{"fsGroup":1000,"runAsGroup":1000,"runAsNonRoot":true,"runAsUser":1000,"securityContext":null},"service":{"name":"ledgerwriter","ports":[{"name":"http","port":8080,"targetPort":8080}],"type":"ClusterIP"},"serviceAccountName":"default","terminationGracePeriodSeconds":5,"volumes":[{"name":"publickey","secret":{"items":[{"key":"jwtRS256.key.pub","path":"publickey"}],"secretName":"jwt-key"}},{"emptyDir":{},"name":"tmp"}]}` | configuration for ledgerwriter deployment |
| deployments.ledger-writer.container.env.ENABLE_TRACING | string | `"false"` | toggle Cloud Trace export |
| deployments.ledger-writer.container.env.JVM_OPTS | string | `"-XX:+UnlockExperimentalVMOptions -XX:+UseCGroupMemoryLimitForHeap -Xms256m -Xmx512m"` | tell Java to obey container memory limits |
| deployments.ledger-writer.container.env.LOG_LEVEL | string | `"info"` | If no valid level is set, will default to info. |
| deployments.ledger-writer.container.image | string | `"gcr.io/bank-of-anthos-ci/ledgerwriter"` | version tag is set by appVersion value |
| deployments.loadgenerator | object | `{"app":"loadgenerator","container":{"command":["locust","--autostart"],"env":{"LOCUST_HOST":"http://frontend","LOCUST_LOGLEVEL":"info","LOCUST_SPAWN_RATE":"1","LOCUST_USERS":"5","LOCUST_WEB_PORT":"8080"},"image":"gcr.io/bank-of-anthos-ci/loadgenerator","name":"loadgenerator","resources":{"limits":{"cpu":"250m","memory":"1Gi"},"requests":{"cpu":"100m","memory":"512Mi"}},"securityContext":{"allowPrivilegeEscalation":false,"capabilities":{"drop":["all"]},"privileged":false,"readOnlyRootFilesystem":true}},"name":"loadgenerator","podAnnotations":{"sidecar.istio.io/rewriteAppHTTPProbers":"true"},"podSecurityContext":{"fsGroup":1000,"runAsGroup":1000,"runAsNonRoot":true,"runAsUser":1000},"replicas":1,"restartPolicy":"Always","serviceAccountName":"default","terminationGracePeriodSeconds":5}` | configuration for loadgenerator deployment |
| deployments.loadgenerator.container.image | string | `"gcr.io/bank-of-anthos-ci/loadgenerator"` | version tag is set by appVersion value |
| deployments.transaction-history | object | `{"app":"transactionhistory","container":{"env":{"CACHE_MINUTES":"60","CACHE_SIZE":"1000","ENABLE_METRICS":"false","ENABLE_TRACING":"false","HISTORY_LIMIT":"100","JVM_OPTS":"-XX:+UnlockExperimentalVMOptions -XX:+UseCGroupMemoryLimitForHeap -Xms256m -Xmx512m","LOG_LEVEL":"info","POLL_MS":"100","PORT":"8080","VERSION":"{{ $.Values.appVersion }}"},"envFrom":"- configMapRef:\n    name: {{ $.Values.configMaps.environment.name }}\n# -- add ledger-db credentials from ConfigMap\n- configMapRef:\n    name: {{ $.Values.configMaps.ledgerdb.name }}\n","extraEnv":[{"name":"NAMESPACE","valueFrom":{"fieldRef":{"fieldPath":"metadata.namespace"}}}],"image":"gcr.io/bank-of-anthos-ci/transactionhistory","livenessProbe":{"httpGet":{"path":"/healthy","port":8080},"initialDelaySeconds":120,"periodSeconds":5,"timeoutSeconds":10},"name":"transactionhistory","readinessProbe":{"httpGet":{"path":"/ready","port":8080},"initialDelaySeconds":60,"periodSeconds":5,"timeoutSeconds":10},"resources":{"limits":{"cpu":"500m","memory":"512Mi"},"requests":{"cpu":"100m","memory":"256Mi"}},"securityContext":{"allowPrivilegeEscalation":false,"capabilities":{"drop":["all"]},"privileged":false,"readOnlyRootFilesystem":true},"startupProbe":{"failureThreshold":30,"httpGet":{"path":"/healthy","port":8080},"periodSeconds":10},"volumeMounts":[{"mountPath":"/tmp/.ssh","name":"publickey","readOnly":true},{"mountPath":"/tmp","name":"tmp"}]},"name":"transactionhistory","podAnnotations":{},"podSecurityContext":{"fsGroup":1000,"runAsGroup":1000,"runAsNonRoot":true,"runAsUser":1000},"service":{"name":"transactionhistory","ports":[{"name":"http","port":8080,"targetPort":8080}],"type":"ClusterIP"},"serviceAccountName":"default","terminationGracePeriodSeconds":5,"volumes":[{"name":"publickey","secret":{"items":[{"key":"jwtRS256.key.pub","path":"publickey"}],"secretName":"jwt-key"}},{"emptyDir":{},"name":"tmp"}]}` | configuration for transactionhistory deployment |
| deployments.transaction-history.container.env.ENABLE_TRACING | string | `"false"` | toggle Cloud Trace export |
| deployments.transaction-history.container.env.JVM_OPTS | string | `"-XX:+UnlockExperimentalVMOptions -XX:+UseCGroupMemoryLimitForHeap -Xms256m -Xmx512m"` | tell Java to obey container memory limits |
| deployments.transaction-history.container.env.LOG_LEVEL | string | `"info"` | Valid levels are debug, info, warn, error, fatal. If no valid level is set, will default to info. |
| deployments.transaction-history.container.image | string | `"gcr.io/bank-of-anthos-ci/transactionhistory"` | version tag is set by appVersion value |
| deployments.userservice | object | `{"app":"userservice","container":{"env":{"ENABLE_TRACING":"false","LOG_LEVEL":"info","PORT":"8080","PRIV_KEY_PATH":"/tmp/.ssh/privatekey","TOKEN_EXPIRY_SECONDS":"3600","VERSION":"{{ $.Values.appVersion }}"},"envFrom":"- configMapRef:\n    name: {{ $.Values.configMaps.environment.name }}\n- configMapRef:\n    name: {{ $.Values.configMaps.accountsdb.name }}\n","image":"gcr.io/bank-of-anthos-ci/userservice","name":"userservice","ports":[{"containerPort":8080,"name":"http-server"}],"readinessProbe":{"httpGet":{"path":"/ready","port":8080},"initialDelaySeconds":10,"periodSeconds":5,"timeoutSeconds":10},"resources":{"limits":{"cpu":"500m","memory":"256Mi"},"requests":{"cpu":"300m","memory":"128Mi"}},"securityContext":{"allowPrivilegeEscalation":false,"capabilities":{"drop":["all"]},"privileged":false,"readOnlyRootFilesystem":true},"volumeMounts":[{"mountPath":"/tmp/.ssh","name":"keys","readOnly":true},{"mountPath":"/tmp","name":"tmp"}]},"name":"userservice","podAnnotations":{},"podSecurityContext":{"fsGroup":1000,"runAsGroup":1000,"runAsNonRoot":true,"runAsUser":1000},"service":{"name":"userservice","ports":[{"name":"http","port":8080,"targetPort":8080}],"type":"ClusterIP"},"serviceAccountName":"default","terminationGracePeriodSeconds":5,"volumes":[{"name":"keys","secret":{"items":[{"key":"jwtRS256.key","path":"privatekey"},{"key":"jwtRS256.key.pub","path":"publickey"}],"secretName":"jwt-key"}},{"emptyDir":{},"name":"tmp"}]}` | configuration for userservice deployment |
| deployments.userservice.container.env.ENABLE_TRACING | string | `"false"` | toggle Cloud Trace export |
| deployments.userservice.container.env.LOG_LEVEL | string | `"info"` | Valid levels are debug, info, warn, error, fatal. If no valid level is set, will default to info. |
| deployments.userservice.container.image | string | `"gcr.io/bank-of-anthos-ci/userservice"` | version tag is set by appVersion value |
| fullnameOverride | string | `""` |  |
| nameOverride | string | `""` |  |
| secret | object | `{"enabled":false,"jwtRS256Key":"","jwtRS256KeyPub":""}` | This secret contains a keypair used to sign and verify JWTs for authentication. In practice, this should never be checked into version control. It is provided here to simplify deployment **JWT Key Pair Secret** Bank of Anthos uses [Json Web Tokens (JWTs)](https://jwt.io/introduction/) to handle user authentication. JWTs use asymmetric key pairs to sign and verify tokens. In this case, `userservice` creates and signs tokens with a RSA private key when a user logs in, and the other services use the corresponding public key to validate the user. **Creating Secret Manually**   \$`openssl genrsa -out jwtRS256.key 4096`   \$`openssl rsa -in jwtRS256.key -outform PEM -pubout -out jwtRS256.key.pub`   \$`kubectl create secret generic jwt-key --from-file=./jwtRS256.key --from-file=./jwtRS256.key.pub`  |
| secret.enabled | bool | `false` | secret should be created by helm chart |
| secret.jwtRS256Key | string | `""` | JWT private key |
| secret.jwtRS256KeyPub | string | `""` | JWT public key |
| statefulsets | object | `{"accountsdb":{"additionalLabels":{"tier":"db"},"app":"accounts-db","container":{"envFrom":"- configMapRef:\n    name: {{ $.Values.configMaps.environment.name }}\n- configMapRef:\n    name: {{ $.Values.configMaps.accountsdb.name }}\n- configMapRef:\n    name: {{ $.Values.configMaps.demoData.name }}\n","image":"gcr.io/bank-of-anthos-ci/accounts-db","name":"accounts-db","ports":[{"containerPort":5432,"name":"postgredb"}],"resources":{"limits":{"cpu":"250m","memory":"512Mi"},"requests":{"cpu":"100m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/var/lib/postgresql/data","name":"postgresdb","subPath":"postgres"}]},"name":"accounts-db","podAnnotations":{},"replicas":1,"service":{"name":"accounts-db","ports":[{"name":"tcp","port":5432,"protocol":"TCP","targetPort":5432}]},"serviceAccountName":"default","serviceName":"accounts-db","volumes":[{"emptyDir":{},"name":"postgresdb"}]},"ledger-db":{"app":"ledger-db","container":{"envFrom":"- configMapRef:\n    name: {{ $.Values.configMaps.environment.name }}\n- configMapRef:\n    name: {{ $.Values.configMaps.ledgerdb.name }}\n- configMapRef:\n    name: {{ $.Values.configMaps.demoData.name }}\n","image":"gcr.io/bank-of-anthos-ci/ledger-db","name":"postgres","ports":[{"containerPort":5432}],"resources":{"limits":{"cpu":"250m","memory":"1Gi"},"requests":{"cpu":"100m","memory":"512Mi"}},"volumeMounts":[{"mountPath":"/var/lib/postgresql/data","name":"postgresdb","subPath":"postgres"}]},"name":"ledger-db","podAnnotations":{},"replicas":1,"service":{"name":"ledger-db","ports":[{"name":"tcp","port":5432,"targetPort":5432}]},"serviceAccountName":"default","serviceName":"ledger-db","volumes":[{"emptyDir":{},"name":"postgresdb"}]}}` | values for the statefulsets accounts-db and ledger-db |
| statefulsets.accountsdb | object | `{"additionalLabels":{"tier":"db"},"app":"accounts-db","container":{"envFrom":"- configMapRef:\n    name: {{ $.Values.configMaps.environment.name }}\n- configMapRef:\n    name: {{ $.Values.configMaps.accountsdb.name }}\n- configMapRef:\n    name: {{ $.Values.configMaps.demoData.name }}\n","image":"gcr.io/bank-of-anthos-ci/accounts-db","name":"accounts-db","ports":[{"containerPort":5432,"name":"postgredb"}],"resources":{"limits":{"cpu":"250m","memory":"512Mi"},"requests":{"cpu":"100m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/var/lib/postgresql/data","name":"postgresdb","subPath":"postgres"}]},"name":"accounts-db","podAnnotations":{},"replicas":1,"service":{"name":"accounts-db","ports":[{"name":"tcp","port":5432,"protocol":"TCP","targetPort":5432}]},"serviceAccountName":"default","serviceName":"accounts-db","volumes":[{"emptyDir":{},"name":"postgresdb"}]}` | configuration for accountsdb statefulset |
| statefulsets.accountsdb.container.image | string | `"gcr.io/bank-of-anthos-ci/accounts-db"` | version tag is set by appVersion value |
| statefulsets.ledger-db | object | `{"app":"ledger-db","container":{"envFrom":"- configMapRef:\n    name: {{ $.Values.configMaps.environment.name }}\n- configMapRef:\n    name: {{ $.Values.configMaps.ledgerdb.name }}\n- configMapRef:\n    name: {{ $.Values.configMaps.demoData.name }}\n","image":"gcr.io/bank-of-anthos-ci/ledger-db","name":"postgres","ports":[{"containerPort":5432}],"resources":{"limits":{"cpu":"250m","memory":"1Gi"},"requests":{"cpu":"100m","memory":"512Mi"}},"volumeMounts":[{"mountPath":"/var/lib/postgresql/data","name":"postgresdb","subPath":"postgres"}]},"name":"ledger-db","podAnnotations":{},"replicas":1,"service":{"name":"ledger-db","ports":[{"name":"tcp","port":5432,"targetPort":5432}]},"serviceAccountName":"default","serviceName":"ledger-db","volumes":[{"emptyDir":{},"name":"postgresdb"}]}` | configuration for ledger-db statefulset |
| statefulsets.ledger-db.container.image | string | `"gcr.io/bank-of-anthos-ci/ledger-db"` | version tag is set by appVersion value |

----------------------------------------------
Autogenerated from chart metadata using [helm-docs v1.11.0](https://github.com/norwoodj/helm-docs/releases/v1.11.0)
